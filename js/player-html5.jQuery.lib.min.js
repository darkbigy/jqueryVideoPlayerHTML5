(function(a){a.fn.jQueryVideoHTML5=function(b){var c=a.extend({version:"SD",theme:"default-theme.html",themePath:"./themes-player-jQ/",defaultVolume:0.5,fontSize:"12pt",displayEmptyStrMenu:false,displayEmptyQualMenu:false,skipStep:5,volumeStep:0.1,activeKeyboard:true,isFullScreenOnPlay:false,displayControllerOnlyFullScreen:false,activateContextualMenu:true},b);var e=0;var d=this;var f=false;this.parseTimeCode=function(h){h=Math.floor(h);var g=0;while(h-60>0){h=h-60;g++}var k=h.toString();if(k.length==1){k="0"+k}var j=g.toString();if(j.length==1){j="0"+j}return j+":"+k};this.activateKeyboard=function(g){c.activeKeyboard=g};return this.each(function(){var K=({isHoldingTime:false,isHoldingVolume:false,isFullscreen:false,isTrueFullscreen:false,fsStyle:null,fsVideoStyle:null,video:a(this),parent_container:null,id_video:++e,subs:[],mouseHoverPlayer:false});var E=function(){a.ajax({url:c.themePath+c.theme,dataType:"html",success:function(M){K.video.removeAttr("controls").before(a("<div></div>").attr("class","jqVideo5_wrapper").attr("data-tabindex","0").html(M));K.video.appendTo(a(".jqVideo5_video_container",K.video.prev()));K.parent_container=K.video.parents(".jqVideo5_wrapper");u();m();k();K.video[0].volume=c.defaultVolume;q(false,null);h();v(!c.displayControllerOnlyFullScreen);if(!c.activateContextualMenu){video.bind("contextmenu",function(){return false})}},error:function(M){alert(M)}})};var u=function(){K.video.on("click",function(){J()});K.video.on("timeupdate",function(){h();H()});K.video.on("ended",function(){j()});K.video.on("play",function(){n()});K.video.on("pause",function(){n()});K.video.on("volumechange",function(){w()});K.video.on("progress",function(){G()});K.video.on("loadstart",function(){h()});a(".jqVideo5_play_btn",K.parent_container).on("click",function(){J();a(this).blur()});a(".jqVideo5_timebar",K.parent_container).mousedown(function(){K.isHoldingTime=true});a(".jqVideo5_timebar",K.parent_container).mouseup(function(M){K.isHoldingTime=false;F(M,true)});(a(".jqVideo5_timebar",K.parent_container).parent()).mousemove(function(M){p(M);if(K.isHoldingTime){F(M,false)}});a(".jqVideo5_fullscreen_btn",K.parent_container).click(function(){r();a(this).blur()});a(document).on("mozfullscreenchange",function(){if(!a(document)[0].mozFullScreen&&K.isTrueFullscreen){r()}});a(document).on("webkitfullscreenchange",function(){if(!a(document)[0].webkitIsFullScreen&&K.isTrueFullscreen){r()}});a(".jqVideo5_volumebar",K.parent_container).mousedown(function(){K.isHoldingVolume=true});a(".jqVideo5_volumebar",K.parent_container).mouseup(function(M){K.isHoldingVolume=false;q(true,M)});a(".jqVideo5_volumebar",K.parent_container).mousemove(function(M){if(K.isHoldingVolume){q(true,M)}});a(".jqVideo5_sound_btn",K.parent_container).click(function(){A();a(this).blur()});K.parent_container.hover(function(){K.mouseHoverPlayer=true},function(){K.mouseHoverPlayer=false;if(!K.video[0].paused){L(false)}});K.parent_container.mousemove(function(){g()});a(document).on("keydown",function(M){o(M)})};var v=function(M){if(M){a(".jqVideo5_controls",K.parent_container).show()}else{a(".jqVideo5_controls",K.parent_container).hide()}};var L=function(M){if(M){K.parent_container.css("cursor","auto");a(".jqVideo5_controls",K.parent_container).css("opacity",1)}else{K.parent_container.css("cursor","none");a(".jqVideo5_controls",K.parent_container).css("opacity",0)}};var o=function(M){if(c.activeKeyboard&&M.type=="keydown"){switch(M.keyCode){case 13:if(M.altKey){r()}break;case 32:J();break;case 37:if(K.video[0].currentTime-c.skipStep<0){K.video[0].currentTime=0}else{K.video[0].currentTime-=c.skipStep}break;case 38:if(K.video[0].volume+c.volumeStep>1){K.video[0].volume=1}else{K.video[0].volume+=c.volumeStep}q(false,null);break;case 39:if(K.video[0].currentTime+c.skipStep>K.video[0].duration){K.video[0].currentTime=K.video[0].duration}else{K.video[0].currentTime+=c.skipStep}break;case 40:if(K.video[0].volume-c.volumeStep<0){K.video[0].volume=0}else{K.video[0].volume-=c.volumeStep}q(false,null);break}}};var k=function(){var M=[];a.each(a("source",K.video),function(){var O=false;for(i=0;i<M.length&&!O;++i){if(M[i]==a(this).attr("data-version")){O=true}}if(!O){M.push(a(this).attr("data-version"))}});if(M.length>1&&M[0]!="undefined"){a(".jqVideo5_version",K.parent_container).html(a(".jqVideo5_menu_title",a(".jqVideo5_version",K.parent_container)));for(i=0;i<M.length;++i){a(".jqVideo5_version",K.parent_container).append('<li class="jqVideo5_version_item"><label><input type="radio" value="'+M[i]+'" name="jqVideo5_current_version_'+K.id_video+'"/> '+M[i]+"</label></li>")}var N=a("input",a(".jqVideo5_version",K.parent_container));for(i=0;i<N.length;++i){if((a(N[i]).val()==c.version)||(a(N[i]).val()==a('source[src="'+K.video[0].currentSrc+'"]',K.video).attr("data-version"))){a(N[i]).prop("checked",true);break}}s();for(i=0;i<N.length;++i){a(N[i]).on("change",function(){s()})}}else{if(!c.displayEmptyQualMenu){a(".jqVideo5_version_list",K.parent_container).css("display","none")}}};var s=function(){var O=a("li.jqVideo5_version_item",K.parent_container);var N=a("input",a(".jqVideo5_version",K.parent_container));var M=0;for(i=0;i<N.length;++i){if(a(N[i]).prop("checked")){a(O[i]).attr("class","jqVideo5_version_item active_track");M=i}else{a(O[i]).attr("class","jqVideo5_version_item")}}x(a(N[M]).val())};var x=function(N){var R=a("source",K.video);var P=[];for(i=0;i<R.length;++i){if(a(R[i]).attr("data-version")==N){P.push(R[i])}}var M=false;for(i=0;i<P.length&&!M;++i){if(K.video[0].canPlayType(a(P[i]).attr("type"))){var Q=K.video[0].paused;var O=K.video[0].currentTime;K.video[0].pause();K.video[0].src=a(P[i]).attr("src");K.video[0].load();if(!Q){J()}K.video.on("loadeddata",function(){K.video[0].currentTime=O});M=true}}};var m=function(){var M=a("track",K.video);var N=0;if(M.length>0){I(0,M)}else{a(".jqVideo5_sub",K.parent_container).css("display","none")}};var I=function(M,O){var N=a(O.get(M));a.ajax({url:N.attr("src"),dataType:"html",success:function(R){if(R!=""){var Q=N.attr("kind");if(Q==null||Q==""){Q="subtitles"}B(R,Q);if(Q=="subtitles"||Q=="captions"||Q=="descriptions"){var P=N.attr("label");var S=N.attr("srclang");if(P!=null){track_label=P}else{if(S!=null){track_label=S}else{track_label="Track "+(M+1)}}a(".jqVideo5_cc_tracks",K.parent_container).append('<li class="jqVideo5_subtitles_item"><label><input type="radio" value="'+M+'" name="jqVideo5_current_cc_'+K.id_video+'"/> '+track_label+"</label></li>")}++M;if(M<O.length){I(M,O)}else{l(O)}}},error:function(P){alert(P)}})};var l=function(N){var O=a("input",a(".jqVideo5_cc_tracks",K.parent_container));var M=0;a(O[0]).attr("value",-1).attr("name",a(O[0]).attr("name")+K.id_video);a(O[0]).on("change",function(){D()});for(i=0;i<N.length;++i){if(a(N[i]).attr("kind")=="subtitles"){if(a(N[i]).attr("srclang")=="lang"&&M==0){M=i+1}if(a(N[i]).is("default")){M=i+1}a(O[i+1]).on("change",function(){D()})}}if(a(O[M])){a(O[M]).prop("checked",true)}else{a(O[0]).prop("checked",true)}D()};var D=function(){var N=a("li.jqVideo5_subtitles_item",K.parent_container);var M=a("input",a(".jqVideo5_cc_tracks",K.parent_container));for(i=0;i<M.length;++i){if(a(M[i]).prop("checked")){if(i==0){a(".jqVideo5_captions",K.parent_container).hide()}a(N[i]).attr("class","jqVideo5_subtitles_item active_track")}else{a(N[i]).attr("class","jqVideo5_subtitles_item")}}};var B=function(O,Q){if(Q=="subtitles"||Q=="captions"||Q=="descriptions"){var R=/^([0-9]+)$/}var S=/^([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3}) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3})(.*)$/;var P=O.split(/\r?\n/);var N=[];for(i=0;i<P.length;i++){if(identifier=R.exec(P[i])){i++;var M=S.exec(P[i]);if(M&&i<P.length){i++;var T=P[i++];while(P[i]!=""&&i<P.length){T=T+"\n"+P[i];i++}N.push({identifier:identifier[0],start:z(M[1]),stop:z(M[2]),start_tc:M[1],stop_tc:M[2],text:T,settings:M[3]})}}K.subs.push(N)}};var z=function(M){var N=M.split(":");return N[0]*60*60+N[1]*60+parseFloat(N[2].replace(",","."))};var H=function(){var U=a(".jqVideo5_captions",K.parent_container);var ao=a("input",a(".jqVideo5_cc_tracks",K.parent_container));var X=-1;for(var an=0;an<ao.length;an++){if(a(ao[an]).prop("checked")){X=a(ao[an]).val()}}if(X>-1){for(an=0;an<K.subs[X].length;an++){if(K.video[0].currentTime>=K.subs[X][an].start&&K.video[0].currentTime<=K.subs[X][an].stop){var af=K.subs[X][an].text;var O=K.video.parents(".jqVideo5_captions_wrapper");var M=["jqVideo5_captions_wrapper"];var ap=["jqVideo5_captions"];var T=a("<span></span>").css("text-align","center");var V=a("<p></p>");var ad=a("<span></span>");var aa=a("<span></span>");var R=/<v ([^>]+)>/i;while(test_vd=R.exec(af)){af=af.replace(test_vd[0],'<span class="'+test_vd[1].replace(" ","_")+'">')}var aq=/<c\.([a-z0-9-_.]+)>/i;while(test_classes=aq.exec(af)){var ah=test_classes[1].replace("."," ");af=af.replace(test_classes[0],'<span class="'+ah+'">')}af=af.replace(/(<\/v>|<\/c>)/ig,"</span>");var ac=/<([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3})>/;var am=false;while(test_timestamps=ac.exec(af)){if(this.tc2sec(test_timestamps[1])<this.params.video.currentTime){af=af.replace(test_timestamps[0],'</span><span class="jqVideo5_cue_past">')}else{af=af.replace(test_timestamps[0],'</span><span class="jqVideo5_cue_future">')}am=true}if(am){af='<span class="jqVideo5_cue_past">'+af}if(K.subs[X][an].settings!=""){var S=/(A|align):(start|middle|end)/i;var ab=/(S|size):([0-9]{0,3})%/i;var ae=/(T|position):([0-9]{0,3})%/i;var Q=/(D|vertical):(vertical-lr|vertical|lr|rl)/i;var W=/(L|line):(-?[0-9]{0,3})(%?)/i;var N=S.exec(K.subs[X][an].settings);var aj=ab.exec(K.subs[X][an].settings);var al=ae.exec(K.subs[X][an].settings);var Z=Q.exec(K.subs[X][an].settings);var ak=W.exec(K.subs[X][an].settings);if(N){if(N[2]=="start"){V.css("text-align","left")}else{if(N[2]=="middle"){V.css("text-align","center")}else{if(N[2]=="end"){V.css("text-align","right")}}}}if(al&&al[2]>=0&&al[2]<50){T.css("text-align","left");V.css("margin-left",al[1]+"%")}else{if(al&&al[2]>50&&al[2]<=100){T.css("text-align","right");V.css("margin-left",(100-al[2])+"%")}}if(aj){var Y=(aj[2]/100)*parseInt(this.config.fontSize);V.css("font-size",Y+"pt")}if(Z){aa.css("display","block");aa.css("min-height","5px");aa.css("min-width","1px");af='<span style="'+aa.attr("style")+'">'+af.split("").join('</span><span style="'+aa.attr("style")+'">')+"</span>";af=af.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1</span><br /><span>$2");ad.css("display","block").css("padding","5px").css("text-align","center");if(Z[2]=="vertical-lr"||Z[2]=="lr"){ad.css("float","left");V.css("float","left")}else{ad.css("float","right");V.css("float","right")}ad.css("background-color","rgba(0,0,0,0.75)");V.css("background","none");T.css("top","0");af=af.replace(/<br \/>/,'</span><span style="'+ad.attr("style")+'">');af=af.replace(/<span>(\r\n|\n\r|\r|\n)<\/span>/g,"")}if(ak&&ak[2]>=-100&&ak[2]<=100){if(ak[3]=="%"){var P=(ak[2]<0)?"bottom":"top";var ai=Math.abs(ak[2]);T.css(P,ai+"%")}}}if(K.isFullscreen){var ag=Math.round((window.innerHeight-30)/K.fsVideoStyle.height*100)/100;V.css("font-size",Math.round(parseInt(c.fontSize)*ag)+"pt")}O.attr("class",M.join(" "));U.attr("class",ap.join(" ")).attr("style",T.attr("style")).css("visibility","visible").css("bottom",a(".jqVideo5_controls",K.parent_container).css("height"));if(!Z){af=af.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1</span><br /><span style="'+ad.attr("style")+'">$2')}U.html(V.append(ad.append(af)))}}}};var r=function(){var N=a(".jqVideo5_wrapper");var P=K.parent_container;var M=a(".jqVideo5_captions",P);if(!K.isFullscreen){v(true);for(i=0;i<N.length;++i){N.css("visibility","hidden")}P.css("visibility","visible");K.fsStyle=({height:P.css("height"),width:P.css("width")});K.fsVideoStyle=({height:K.video.height(),width:K.video.width()});if((a("html")[0]).requestFullscreen){K.isTrueFullscreen=true;(a("html")[0]).requestFullscreen()}else{if((a("html")[0]).mozRequestFullScreen){K.isTrueFullscreen=true;(a("html")[0]).mozRequestFullScreen()}else{if((a("html")[0]).webkitRequestFullScreen){K.isTrueFullscreen=true;(a("html")[0]).webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}}}if(K.isTrueFullscreen){P.css("position","fixed").css("top",0).css("left",0).css("height","100%").css("width","100%").css("backgroundColor","#000000");K.video.css("width","100%").css("height",(screen.height-30)+"px");a("body").css("overflow","hidden")}else{P.css("position","fixed").css("top",0).css("left","50%").css("height",screen.height+"px").css("width",screen.width+"px").css("background-color","#000000").css("margin-left","-"+Math.round(P.width()/2)+"px");K.video.css("width",a(window).innerWidth()+"px").css("height",(a(window).innerHeight()-30)+"px");a("body").css("overflow","hidden")}K.isFullscreen=true;P.attr("class",P.attr("class")+(P.attr("class")?" ":"")+"jqVideo5_is_fullscreen");var O=Math.round((window.innerHeight-30)/K.fsVideoStyle.height*100)/100;a("p",a(".jqVideo5_captions",K.parent_container)).css("font-size",Math.round(parseInt(c.fontSize)*O)+"pt")}else{if(c.isFullScreenOnPlay&&!K.video[0].paused){J()}v(!c.displayControllerOnlyFullScreen);a("body").css("cursor","auto");if(a(document)[0].cancelFullscreen){a(document)[0].cancelFullscreen()}else{if(a(document)[0].exitFullscreen){a(document)[0].exitFullscreen()}else{if(a(document)[0].mozCancelFullScreen){a(document)[0].mozCancelFullScreen()}else{if(a(document)[0].webkitCancelFullScreen){a(document)[0].webkitCancelFullScreen()}}}}for(i=0;i<N.length;++i){N.css("visibility","visible")}P.css("position","inherit").css("left",0).css("height",K.fsStyle.height).css("width",K.fsStyle.width).css("background-color","transparent").css("margin-left",0);K.video.css("height",K.fsVideoStyle.height+"px").css("width",K.fsVideoStyle.width+"px");a("body").css("overflow","auto");K.isFullscreen=false;K.isTrueFullscreen=false;P.attr("class",P.attr("class").replace(new RegExp("(\\s|^)jqVideo5_is_fullscreen(\\s|$)")," ").replace(/^\s+|\s+$/g,""));a("p",a(".jqVideo5_captions",K.parent_container)).css("font-size","")}a(".jqVideo5_video_container",P).css("height",K.video.height()+"px")};var g=function(){if(!K.video[0].paused&&K.mouseHoverPlayer){C()}};var C=function(){L(true);clearTimeout(f);f=setTimeout(function(){L(false)},3000)};var q=function(N,O){var R=0;if(N){var P=a(".jqVideo5_volumebar",K.parent_container);var Q=t(P[0]);var M=O.pageY-Q.y;R=100-Math.round(M*100/P.height());if(R>0){K.video[0].muted=false}}else{R=K.video[0].volume*100}if(R<=100){if(R<0){R=0;K.video[0].muted=true}a(".jqVideo5_volumebar_inner",K.parent_container).css("height",R.toString()+"%");K.video[0].volume=R/100;a(".jqVideo5_volume_ctrl",K.parent_container).attr("aria-valuenow",R/100)}};var A=function(){if(!K.video[0].muted){K.video[0].muted=true}else{K.video[0].muted=false}if(K.video[0].volume==0){K.video[0].volume=c.defaultVolume;q(false,null)}};var t=function(N){var M=y=0;if(N.offsetParent){do{M+=N.offsetLeft;y+=N.offsetTop}while(N=N.offsetParent)}return{x:M,y:y}};var F=function(N,R){var Q=a(".jqVideo5_timebar",K.parent_container);var P=t(Q[0]);var M=N.clientX-P.x;var O=Math.round(M*100/Q[0].offsetWidth);a(".jqVideo5_timebar_inner",K.parent_container).css("width",O.toString()+"%");if(R){K.video[0].currentTime=Math.round(O*K.video[0].duration/100)}};var p=function(N){var R=a(".jqVideo5_timebar",K.parent_container);var P=a(".jqVideo5_timebar_notice",K.parent_container);var Q=t(R[0]);var M=N.clientX-Q.x;var O=Math.round(M*100/R[0].offsetWidth);if(O<0){O=0}P.html(d.parseTimeCode(Math.round(O*K.video[0].duration/100)));P.css("marginLeft",(M+3-P[0].offsetWidth/2)+"px")};var G=function(){if(K.video[0].buffered.length==0){return}var N=K.video[0].buffered.end(0);if(N==K.video[0].duration){a(".jqVideo5_timebar_buffer",K.parent_container).css("width",(a(".jqVideo5_timebar",K.parent_container).css("offsetWidth")-2)+"px")}else{var O=a(".jqVideo5_timebar",K.parent_container).css("offsetWidth");var M=Math.round((N*O)/K.video[0].duration);a(".jqVideo5_timebar_buffer",K.parent_container).css("width",M+"px")}};var w=function(){if(K.video[0].volume==0||K.video[0].muted){a(".jqVideo5_sound_btn").addClass("mute")}else{if(a(".jqVideo5_sound_btn").hasClass("mute")){a(".jqVideo5_sound_btn").removeClass("mute")}}};var n=function(){a(".jqVideo5_play_btn").toggleClass("pause")};var j=function(){K.video[0].currentTime=0;K.video[0].pause();a(".jqVideo5_play_btn").toggleClass("pause");L(true)};var h=function(){a(".jqVideo5_timebar",K.parent_container).attr("aria-valuemax",Math.round(K.video[0].duration*100)/100);a(".jqVideo5_timebar",K.parent_container).attr("aria-valuenow",K.video[0].currentTime);a(".jqVideo5_video_curpos",K.parent_container).html(d.parseTimeCode(K.video[0].currentTime));if(a(".jqVideo5_video_duration",K.parent_container).html()=="00:00"||d.parseTimeCode(K.video[0].duration!=a(".jqVideo5_video_duration",K.parent_container).html())){a(".jqVideo5_video_duration",K.parent_container).html(d.parseTimeCode(K.video[0].duration))}if(!K.isHoldingTime){a(".jqVideo5_timebar_inner",K.parent_container).css("width",K.video[0].currentTime*100/K.video[0].duration+"%")}};var J=function(){if(K.video[0].paused){K.video[0].play();L(K.mouseHoverPlayer);C();if(c.isFullScreenOnPlay&&!K.isFullscreen){r()}}else{K.video[0].pause();L(true);clearTimeout(f)}};E();return a(this)})}})(jQuery);