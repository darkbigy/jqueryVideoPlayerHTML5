(function(a){a.fn.jQueryVideoHTML5=function(b){var c=a.extend({version:"SD",theme:"default-theme.html",themePath:"./themes-player-jQ/",defaultVolume:0.5,fontSize:"12pt",displayEmptyStrMenu:false,displayEmptyQualMenu:false,skipStep:5,volumeStep:0.1,activeKeyboard:true},b);var e=0;var d=this;this.parseTimeCode=function(g){g=Math.floor(g);var f=0;while(g-60>0){g=g-60;f++}var j=g.toString();if(j.length==1){j="0"+j}var h=f.toString();if(h.length==1){h="0"+h}return h+":"+j};this.activateKeyboard=function(f){c.activeKeyboard=f};return this.each(function(){var H=({isHoldingTime:false,isHoldingVolume:false,isFullscreen:false,isTrueFullscreen:false,fsStyle:null,fsVideoStyle:null,video:a(this),parent_container:null,id_video:++e,current_track:-1,subs:[],mouseHoverPlayer:false});var B=function(){a.ajax({url:c.themePath+c.theme,dataType:"html",success:function(I){H.video.removeAttr("controls").before(a("<div></div>").attr("class","jqVideo5_wrapper").attr("data-tabindex","0").html(I));H.video.appendTo(a(".jqVideo5_video_container",H.video.prev()));H.parent_container=H.video.parents(".jqVideo5_wrapper");t();k();h();H.video[0].volume=c.defaultVolume;p(false,null);f()},error:function(I){alert(I)}})};var t=function(){H.video.on("click",function(){G()});H.video.on("timeupdate",function(){f();E()});H.video.on("ended",function(){g()});H.video.on("play",function(){m()});H.video.on("pause",function(){m()});H.video.on("volumechange",function(){u()});H.video.on("progress",function(){D()});H.video.on("loadstart",function(){f()});a(".jqVideo5_play_btn",H.parent_container).on("click",function(){G()});a(".jqVideo5_timebar",H.parent_container).on("mousedown",function(){H.isHoldingTime=true});a(".jqVideo5_timebar",H.parent_container).on("mouseup",function(I){H.isHoldingTime=false;C(I,true)});(a(".jqVideo5_timebar",H.parent_container).parent()).on("mousemove",function(I){o(I);if(H.isHoldingTime){C(I,false)}});a(".jqVideo5_fullscreen_btn",H.parent_container).on("click",function(){q()});a(document).on("mozfullscreenchange",function(){if(!a(document)[0].mozFullScreen&&H.isTrueFullscreen){q()}});a(document).on("webkitfullscreenchange",function(){if(!a(document)[0].webkitIsFullScreen&&H.isTrueFullscreen){q()}});a(".jqVideo5_volumebar",H.parent_container).on("mousedown",function(){H.isHoldingVolume=true});a(".jqVideo5_volumebar",H.parent_container).on("mouseup",function(I){H.isHoldingVolume=false;p(true,I)});a(".jqVideo5_volumebar",H.parent_container).on("mousemove",function(I){if(H.isHoldingVolume){p(true,I)}});a(".jqVideo5_sound_btn",H.parent_container).on("click",function(){x()});a(".jqVideo5_wrapper").hover(function(){l(true)},function(){l(false)});a(document).on("keydown",function(I){n(I)})};var n=function(I){if(c.activeKeyboard){switch(I.keyCode){case 32:G();break;case 37:if(H.video[0].currentTime-c.skipStep<0){H.video[0].currentTime=0}else{H.video[0].currentTime-=c.skipStep}break;case 38:if(H.video[0].volume+c.volumeStep>1){H.video[0].volume=1}else{H.video[0].volume+=c.volumeStep}p(false,null);break;case 39:if(H.video[0].currentTime+c.skipStep>H.video[0].duration){H.video[0].currentTime=H.video[0].duration}else{H.video[0].currentTime+=c.skipStep}break;case 40:if(H.video[0].volume-c.volumeStep<0){H.video[0].volume=0}else{H.video[0].volume-=c.volumeStep}p(false,null);break}I.preventDefault()}};var h=function(){var I=[];a.each(a("source",H.video),function(){var K=false;for(i=0;i<I.length&&!K;++i){if(I[i]==a(this).attr("data-version")){K=true}}if(!K){I.push(a(this).attr("data-version"))}});if(I.length>1&&I[0]!="undefined"){a(".jqVideo5_version",H.parent_container).html(a(".jqVideo5_menu_title",a(".jqVideo5_version",H.parent_container)));for(i=0;i<I.length;++i){a(".jqVideo5_version",H.parent_container).append('<li class="jqVideo5_version_item"><label><input type="radio" value="'+I[i]+'" name="jqVideo5_current_version_'+H.id_video+'"/> '+I[i]+"</label></li>")}var J=a("input",a(".jqVideo5_version",H.parent_container));for(i=0;i<J.length;++i){if((a(J[i]).val()==c.version)||(a(J[i]).val()==a('source[src="'+H.video[0].currentSrc+'"]',H.video).attr("data-version"))){a(J[i]).prop("checked",true);break}}r();for(i=0;i<J.length;++i){a(J[i]).on("change",function(){r()})}}else{if(!c.displayEmptyQualMenu){a(".jqVideo5_version_list",H.parent_container).css("display","none")}}};var r=function(){var J=a("li.jqVideo5_version_item",H.parent_container);var I=a("input",a(".jqVideo5_version",H.parent_container));for(i=0;i<I.length;++i){if(a(I[i]).prop("checked")){a(J[i]).attr("class","jqVideo5_version_item active_track");v(a(I[i]).val())}else{a(J[i]).attr("class","jqVideo5_version_item")}}};var v=function(J){var N=a("source",H.video);var L=[];for(i=0;i<N.length;++i){if(a(N[i]).attr("data-version")==J){L.push(N[i])}}var I=false;for(i=0;i<L.length&&!I;++i){if(H.video[0].canPlayType(a(L[i]).attr("type"))){var M=H.video[0].paused;var K=H.video[0].currentTime;H.video[0].pause();H.video[0].src=a(L[i]).attr("src");H.video[0].load();if(!M){G()}H.video.on("loadeddata",function(){H.video[0].currentTime=K});I=true}}};var k=function(){var I=a("track",H.video);var J=0;if(I.length>0){F(0,I)}else{a(".jqVideo5_sub",H.parent_container).css("display","none")}};var F=function(I,K){var J=a(K.get(I));a.ajax({url:J.attr("src"),dataType:"html",success:function(N){if(N!=""){var M=J.attr("kind");if(M==null||M==""){M="subtitles"}z(N,M);if(M=="subtitles"||M=="captions"||M=="descriptions"){var L=J.attr("label");var O=J.attr("srclang");if(L!=null){track_label=L}else{if(O!=null){track_label=O}else{track_label="Track "+(I+1)}}a(".jqVideo5_cc_tracks",H.parent_container).append('<li class="jqVideo5_subtitles_item"><label><input type="radio" value="'+I+'" name="jqVideo5_current_cc_'+H.id_video+'"/> '+track_label+"</label></li>")}++I;if(I<K.length){F(I,K)}else{j(K)}}},error:function(L){alert(L)}})};var j=function(J){var K=a("input",a(".jqVideo5_cc_tracks",H.parent_container));var I=0;a(K[0]).attr("value",-1).attr("name",a(K[0]).attr("name")+H.id_video);a(K[0]).on("change",function(){A()});for(i=0;i<J.length;++i){if(a(J[i]).attr("kind")=="subtitles"){if(a(J[i]).attr("srclang")=="lang"&&I==0){I=i+1}if(a(J[i]).is("default")){I=i+1}a(K[i+1]).on("change",function(){A()})}}if(a(K[I])){a(K[I]).prop("checked",true)}else{a(K[0]).prop("checked",true)}A()};var A=function(){var J=a("li.jqVideo5_subtitles_item",H.parent_container);var I=a("input",a(".jqVideo5_cc_tracks",H.parent_container));for(i=0;i<I.length;++i){if(a(I[i]).prop("checked")){a(J[i]).attr("class","jqVideo5_subtitles_item active_track")}else{a(J[i]).attr("class","jqVideo5_subtitles_item")}}};var z=function(K,M){if(M=="subtitles"||M=="captions"||M=="descriptions"){var N=/^([0-9]+)$/}var O=/^([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3}) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3})(.*)$/;var L=K.split(/\r?\n/);var J=[];for(i=0;i<L.length;i++){if(identifier=N.exec(L[i])){i++;var I=O.exec(L[i]);if(I&&i<L.length){i++;var P=L[i++];while(L[i]!=""&&i<L.length){P=P+"\n"+L[i];i++}J.push({identifier:identifier[0],start:w(I[1]),stop:w(I[2]),start_tc:I[1],stop_tc:I[2],text:P,settings:I[3]})}}H.subs.push(J)}};var w=function(I){var J=I.split(":");return J[0]*60*60+J[1]*60+parseFloat(J[2].replace(",","."))};var E=function(){var Q=a(".jqVideo5_captions",H.parent_container);var ak=a("input",a(".jqVideo5_cc_tracks",H.parent_container));var T=-1;for(var aj=0;aj<ak.length;aj++){if(a(ak[aj]).prop("checked")){T=a(ak[aj]).val()}}if(T==-1&&Q.css("visibility")=="visible"){Q.hide()}else{for(aj=0;aj<H.subs[T].length;aj++){if(H.video[0].currentTime>=H.subs[T][aj].start&&H.video[0].currentTime<=H.subs[T][aj].stop){var ab=H.subs[T][aj].text;var K=H.video.parents(".jqVideo5_captions_wrapper");var I=["jqVideo5_captions_wrapper"];var al=["jqVideo5_captions"];var P=a("<span></span>").css("text-align","center");var R=a("<p></p>");var Z=a("<span></span>");var W=a("<span></span>");var N=/<v ([^>]+)>/i;while(test_vd=N.exec(ab)){ab=ab.replace(test_vd[0],'<span class="'+test_vd[1].replace(" ","_")+'">')}var am=/<c\.([a-z0-9-_.]+)>/i;while(test_classes=am.exec(ab)){var ad=test_classes[1].replace("."," ");ab=ab.replace(test_classes[0],'<span class="'+ad+'">')}ab=ab.replace(/(<\/v>|<\/c>)/ig,"</span>");var Y=/<([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3})>/;var ai=false;while(test_timestamps=Y.exec(ab)){if(this.tc2sec(test_timestamps[1])<this.params.video.currentTime){ab=ab.replace(test_timestamps[0],'</span><span class="jqVideo5_cue_past">')}else{ab=ab.replace(test_timestamps[0],'</span><span class="jqVideo5_cue_future">')}ai=true}if(ai){ab='<span class="jqVideo5_cue_past">'+ab}if(H.subs[T][aj].settings!=""){var O=/(A|align):(start|middle|end)/i;var X=/(S|size):([0-9]{0,3})%/i;var aa=/(T|position):([0-9]{0,3})%/i;var M=/(D|vertical):(vertical-lr|vertical|lr|rl)/i;var S=/(L|line):(-?[0-9]{0,3})(%?)/i;var J=O.exec(H.subs[T][aj].settings);var af=X.exec(H.subs[T][aj].settings);var ah=aa.exec(H.subs[T][aj].settings);var V=M.exec(H.subs[T][aj].settings);var ag=S.exec(H.subs[T][aj].settings);if(J){if(J[2]=="start"){R.css("text-align","left")}else{if(J[2]=="middle"){R.css("text-align","center")}else{if(J[2]=="end"){R.css("text-align","right")}}}}if(ah&&ah[2]>=0&&ah[2]<50){P.css("text-align","left");R.css("margin-left",ah[1]+"%")}else{if(ah&&ah[2]>50&&ah[2]<=100){P.css("text-align","right");R.css("margin-left",(100-ah[2])+"%")}}if(af){var U=(af[2]/100)*parseInt(this.config.fontSize);R.css("font-size",U+"pt")}if(V){W.css("display","block");W.css("min-height","5px");W.css("min-width","1px");ab='<span style="'+W.attr("style")+'">'+ab.split("").join('</span><span style="'+W.attr("style")+'">')+"</span>";ab=ab.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1</span><br /><span>$2");Z.css("display","block").css("padding","5px").css("text-align","center");if(V[2]=="vertical-lr"||V[2]=="lr"){Z.css("float","left");R.css("float","left")}else{Z.css("float","right");R.css("float","right")}Z.css("background-color","rgba(0,0,0,0.75)");R.css("background","none");P.css("top","0");ab=ab.replace(/<br \/>/,'</span><span style="'+Z.attr("style")+'">');ab=ab.replace(/<span>(\r\n|\n\r|\r|\n)<\/span>/g,"")}if(ag&&ag[2]>=-100&&ag[2]<=100){if(ag[3]=="%"){var L=(ag[2]<0)?"bottom":"top";var ae=Math.abs(ag[2]);P.css(L,ae+"%")}}}if(H.isFullscreen){var ac=Math.round((window.innerHeight-30)/H.fsVideoStyle.height*100)/100;R.css("font-size",Math.round(parseInt(c.fontSize)*ac)+"pt")}K.attr("class",I.join(" "));Q.attr("class",al.join(" ")).attr("style",P.attr("style")).css("visibility","visible").css("bottom",a(".jqVideo5_controls",H.parent_container).css("height"));if(!V){ab=ab.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1</span><br /><span style="'+Z.attr("style")+'">$2')}Q.html(R.append(Z.append(ab)))}}}};var q=function(){var J=a(".jqVideo5_wrapper");var L=H.parent_container;var I=a(".jqVideo5_captions",L);if(!H.isFullscreen){for(i=0;i<J.length;++i){J.css("visibility","hidden")}L.css("visibility","visible");H.fsStyle=({height:L.css("height"),width:L.css("width")});H.fsVideoStyle=({height:H.video.height(),width:H.video.width()});if((a("html")[0]).requestFullscreen){H.isTrueFullscreen=true;(a("html")[0]).requestFullscreen()}else{if((a("html")[0]).mozRequestFullScreen){H.isTrueFullscreen=true;(a("html")[0]).mozRequestFullScreen()}else{if((a("html")[0]).webkitRequestFullScreen){H.isTrueFullscreen=true;(a("html")[0]).webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}}}if(H.isTrueFullscreen){L.css("position","fixed").css("top",0).css("left",0).css("height","100%").css("width","100%").css("backgroundColor","#000000");H.video.css("width","100%").css("height",(screen.height-30)+"px");a("body").css("overflow","hidden")}else{L.css("position","fixed").css("top",0).css("left","50%").css("height",screen.height+"px").css("width",screen.width+"px").css("background-color","#000000").css("margin-left","-"+Math.round(L.width()/2)+"px");H.video.css("width",a(window).innerWidth()+"px").css("height",(a(window).innerHeight()-30)+"px");a("body").css("overflow","hidden")}H.isFullscreen=true;L.attr("class",L.attr("class")+(L.attr("class")?" ":"")+"jqVideo5_is_fullscreen");var K=Math.round((window.innerHeight-30)/H.fsVideoStyle.height*100)/100;a("p",a(".jqVideo5_captions",H.parent_container)).css("font-size",Math.round(parseInt(c.fontSize)*K)+"pt")}else{if(a(document)[0].cancelFullscreen){a(document)[0].cancelFullscreen()}else{if(a(document)[0].exitFullscreen){a(document)[0].exitFullscreen()}else{if(a(document)[0].mozCancelFullScreen){a(document)[0].mozCancelFullScreen()}else{if(a(document)[0].webkitCancelFullScreen){a(document)[0].webkitCancelFullScreen()}}}}for(i=0;i<J.length;++i){J.css("visibility","visible")}L.css("position","inherit").css("left",0).css("height",H.fsStyle.height).css("width",H.fsStyle.width).css("background-color","transparent").css("margin-left",0);H.video.css("height",H.fsVideoStyle.height+"px").css("width",H.fsVideoStyle.width+"px");a("body").css("overflow","auto");H.isFullscreen=false;H.isTrueFullscreen=false;L.attr("class",L.attr("class").replace(new RegExp("(\\s|^)jqVideo5_is_fullscreen(\\s|$)")," ").replace(/^\s+|\s+$/g,""));a("p",a(".jqVideo5_captions",H.parent_container)).css("font-size","")}a(".jqVideo5_video_container",L).css("height",H.video.height()+"px")};var l=function(I){H.mouseHoverPlayer=I;if(!H.video[0].paused){if(I){a(".jqVideo5_controls",H.parent_container).css("opacity",1)}else{a(".jqVideo5_controls",H.parent_container).css("opacity",0)}}};var p=function(J,K){var N=0;if(J){var L=a(".jqVideo5_volumebar",H.parent_container);var M=s(L[0]);var I=K.pageY-M.y;N=100-Math.round(I*100/L.height());if(N>0){H.video[0].muted=false}}else{N=H.video[0].volume*100}if(N<=100){if(N<0){N=0;H.video[0].muted=true}a(".jqVideo5_volumebar_inner",H.parent_container).css("height",N.toString()+"%");H.video[0].volume=N/100;a(".jqVideo5_volume_ctrl",H.parent_container).attr("aria-valuenow",N/100)}};var x=function(){if(!H.video[0].muted){H.video[0].muted=true}else{H.video[0].muted=false}if(H.video[0].volume==0){H.video[0].volume=c.defaultVolume;p(false,null)}};var s=function(J){var I=y=0;if(J.offsetParent){do{I+=J.offsetLeft;y+=J.offsetTop}while(J=J.offsetParent)}return{x:I,y:y}};var C=function(J,N){var M=a(".jqVideo5_timebar",H.parent_container);var L=s(M[0]);var I=J.clientX-L.x;var K=Math.round(I*100/M[0].offsetWidth);a(".jqVideo5_timebar_inner",H.parent_container).css("width",K.toString()+"%");if(N){H.video[0].currentTime=Math.round(K*H.video[0].duration/100)}};var o=function(J){var N=a(".jqVideo5_timebar",H.parent_container);var L=a(".jqVideo5_timebar_notice",H.parent_container);var M=s(N[0]);var I=J.clientX-M.x;var K=Math.round(I*100/N[0].offsetWidth);if(K<0){K=0}L.html(d.parseTimeCode(Math.round(K*H.video[0].duration/100)));L.css("marginLeft",(I+3-L[0].offsetWidth/2)+"px")};var D=function(){if(H.video[0].buffered.length==0){return}var J=H.video[0].buffered.end(0);if(J==H.video[0].duration){a(".jqVideo5_timebar_buffer",H.parent_container).css("width",(a(".jqVideo5_timebar",H.parent_container).css("offsetWidth")-2)+"px")}else{var K=a(".jqVideo5_timebar",H.parent_container).css("offsetWidth");var I=Math.round((J*K)/H.video[0].duration);a(".jqVideo5_timebar_buffer",H.parent_container).css("width",I+"px")}};var u=function(){if(H.video[0].volume==0||H.video[0].muted){a(".jqVideo5_sound_btn").addClass("mute")}else{if(a(".jqVideo5_sound_btn").hasClass("mute")){a(".jqVideo5_sound_btn").removeClass("mute")}}};var m=function(){a(".jqVideo5_play_btn").toggleClass("pause")};var g=function(){H.video[0].currentTime=0;H.video[0].pause();a(".jqVideo5_play_btn").toggleClass("pause");a(".jqVideo5_controls",H.parent_container).css("opacity",1)};var f=function(){a(".jqVideo5_timebar",H.parent_container).attr("aria-valuemax",Math.round(H.video[0].duration*100)/100);a(".jqVideo5_timebar",H.parent_container).attr("aria-valuenow",H.video[0].currentTime);a(".jqVideo5_video_curpos",H.parent_container).html(d.parseTimeCode(H.video[0].currentTime));if(a(".jqVideo5_video_duration",H.parent_container).html()=="00:00"||d.parseTimeCode(H.video[0].duration!=a(".jqVideo5_video_duration",H.parent_container).html())){a(".jqVideo5_video_duration",H.parent_container).html(d.parseTimeCode(H.video[0].duration))}if(!H.isHoldingTime){a(".jqVideo5_timebar_inner",H.parent_container).css("width",H.video[0].currentTime*100/H.video[0].duration+"%")}};var G=function(){if(H.video[0].paused){H.video[0].play();if(!H.mouseHoverPlayer){a(".jqVideo5_controls",H.parent_container).css("opacity",0)}}else{a(".jqVideo5_controls",H.parent_container).css("opacity",1);H.video[0].pause()}};B();return a(this)})}})(jQuery);